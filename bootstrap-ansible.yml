# bootstrap-ansible.yml
# This playbook MUST be run first. Its only job is to install the Ansible collections
# needed by the main playbook, using the --pre flag to resolve dependency issues.
- name: "Bootstrap Ansible dependencies"
  hosts: localhost
  connection: local

  tasks:
    - name: "Install required Ansible collections"
      become: yes
      ansible.builtin.command: "ansible-galaxy collection install community.general community.aur --pre"
      args:
        # This task will only run if the collection is not already installed
        creates: "/root/.ansible/collections/ansible_collections/community/aur"
